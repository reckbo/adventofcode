Part 1:

i =. <@('y =. y ' , ;@(<@('(' , ,&')');._2)@:(,&' '));._2 wd 'clippaste'

through =: (1000 1000 {. ({. ($&1)))/@(-~/\)@:-@(,:~ >:)

turn =: 1 : 'u'

'`off on toggle' =: >`+.`~:

+/@, 3 : i 1000 1000 $ 0


For part 2, use

'`off on toggle' =: (0 >. -)`+`(+ +:)

